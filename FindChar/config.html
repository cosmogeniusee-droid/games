<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–≥—Ä—ã "–ù–∞–π–¥–∏ –ë—É–∫–≤—É!"</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body class="bg-light vh-100">
    <div class="container-fluid h-100 py-4">
        <h1 class="mb-4 text-center">‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä –∏–≥—Ä—ã "–ù–∞–π–¥–∏ –ë—É–∫–≤—É!"</h1>
        <div class="row g-4 h-100">
            <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
            <div class="col-lg-5 d-flex flex-column">
                <div class="card flex-grow-1">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h5>
                        
                        <div class="mb-3">
                            <label for="customTargetsInput" class="form-label">–ë—É–∫–≤—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é, –Ω–∞–ø—Ä–∏–º–µ—Ä: –ê,–ë,–í):</label>
                            <input type="text" id="customTargetsInput" class="form-control" placeholder="–ï—Å–ª–∏ –ø—É—Å—Ç–æ, –±—É–∫–≤—ã –≤—ã–±–µ—Ä—É—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ">
                        </div>

                        <div class="mb-3">
                            <label for="gridSize" class="form-label">–†–∞–∑–º–µ—Ä —Å–µ—Ç–∫–∏: <span id="gridSizeValue" class="fw-bold text-primary">15</span>x<span id="gridSizeValue2" class="fw-bold text-primary">15</span></label>
                            <input type="range" id="gridSize" class="form-range" value="15" min="5" max="30">
                        </div>

                        <div class="mb-3" id="targets-group">
                            <label for="targets" class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª—É—á–∞–π–Ω—ã—Ö –±—É–∫–≤: <span id="targetsValue" class="fw-bold text-primary">3</span></label>
                            <input type="range" id="targets" class="form-range" value="3" min="1" max="10">
                        </div>

                        <div class="mb-3">
                            <label for="min" class="form-label">–ú–∏–Ω. –∫–æ–ª-–≤–æ –∫–∞–∂–¥–æ–π –±—É–∫–≤—ã: <span id="minValue" class="fw-bold text-primary">6</span></label>
                            <input type="range" id="min" class="form-range" value="6" min="1" max="20">
                        </div>

                        <div class="mb-3">
                            <label for="max" class="form-label">–ú–∞–∫—Å. –∫–æ–ª-–≤–æ –∫–∞–∂–¥–æ–π –±—É–∫–≤—ã: <span id="maxValue" class="fw-bold text-primary">12</span></label>
                            <input type="range" id="max" class="form-range" value="12" min="1" max="30">
                        </div>

                        <div class="mb-3">
                            <label for="fontSize" class="form-label">–†–∞–∑–º–µ—Ä –±—É–∫–≤: <span id="fontSizeValue" class="fw-bold text-primary">1.7</span>em</label>
                            <input type="range" id="fontSize" class="form-range" value="1.7" min="1" max="3" step="0.1">
                        </div>

                        <hr>
                        <div class="mt-auto">
                            <div class="mb-3">
                                <label for="urlDisplay" class="form-label">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞:</label>
                                <div class="input-group">
                                    <input type="text" id="urlDisplay" class="form-control" readonly>
                                    <button class="btn btn-outline-secondary" type="button" id="copyBtn">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                                </div>
                            </div>
                            <a id="gameLink" href="#" target="_blank" class="btn btn-success w-100">üöÄ –û—Ç–∫—Ä—ã—Ç—å –∏–≥—Ä—É –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ</a>
                        </div>
                    </div>
                </div>
            </div>
            <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –ü—Ä–µ–≤—å—é -->
            <div class="col-lg-7 d-flex flex-column">
                <div class="card flex-grow-1">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">–ü—Ä–µ–≤—å—é</h5>
                        <div class="flex-grow-1 border rounded overflow-hidden">
                            <iframe id="previewFrame" src="" title="–ü—Ä–µ–≤—å—é –∏–≥—Ä—ã" class="w-100 h-100 border-0"></iframe>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const inputs = {
            customTargets: document.getElementById('customTargetsInput'),
            gridSize: document.getElementById('gridSize'),
            targets: document.getElementById('targets'),
            min: document.getElementById('min'),
            max: document.getElementById('max'),
            fontSize: document.getElementById('fontSize'),
        };

        const valueDisplays = {
            gridSize: document.getElementById('gridSizeValue'),
            gridSize2: document.getElementById('gridSizeValue2'),
            targets: document.getElementById('targetsValue'),
            min: document.getElementById('minValue'),
            max: document.getElementById('maxValue'),
            fontSize: document.getElementById('fontSizeValue'),
        };

        const urlDisplay = document.getElementById('urlDisplay');
        const gameLink = document.getElementById('gameLink');
        const copyBtn = document.getElementById('copyBtn');
        const previewFrame = document.getElementById('previewFrame');
        const targetsGroup = document.getElementById('targets-group');

        function updateValueDisplays() {
            valueDisplays.gridSize.textContent = inputs.gridSize.value;
            valueDisplays.gridSize2.textContent = inputs.gridSize.value;
            valueDisplays.targets.textContent = inputs.targets.value;
            valueDisplays.min.textContent = inputs.min.value;
            valueDisplays.max.textContent = inputs.max.value;
            valueDisplays.fontSize.textContent = inputs.fontSize.value;

            if (parseInt(inputs.max.value) < parseInt(inputs.min.value)) {
                inputs.max.value = inputs.min.value;
                valueDisplays.max.textContent = inputs.max.value;
            }
        }

        function updateLink() {
            const baseUrl = 'index.html';
            const params = new URLSearchParams();
            const customTargetsValue = inputs.customTargets.value.trim().toUpperCase().replace(/[^–ê-–Ø–Å,]/g, '');

            if (customTargetsValue) {
                params.set('customTargets', customTargetsValue);
            } else if (inputs.targets.value !== '3') {
                params.set('targets', inputs.targets.value);
            }
            
            if (inputs.gridSize.value !== '15') params.set('gridSize', inputs.gridSize.value);
            if (inputs.min.value !== '6') params.set('min', inputs.min.value);
            if (inputs.max.value !== '12') params.set('max', inputs.max.value);
            if (inputs.fontSize.value !== '1.7') params.set('fontSize', inputs.fontSize.value);

            const queryString = params.toString();
            const previewUrl = queryString ? `${baseUrl}?${queryString}` : baseUrl;
            const fullUrl = `https://cosmogeniusee-droid.github.io/games/FindChar/${previewUrl}`;
            urlDisplay.value = fullUrl;
            gameLink.href = previewUrl;
            previewFrame.src = fullUrl;
        }

        function copyTextToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                const originalText = copyBtn.textContent;
                copyBtn.textContent = '–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
                setTimeout(() => { copyBtn.textContent = originalText; }, 2000);
            }).catch(err => console.error('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è: ', err));
        }

        Object.values(inputs).forEach(input => {
            input.addEventListener('input', () => {
                updateValueDisplays();
                updateLink();
            });
        });

        inputs.customTargets.addEventListener('input', () => {
            targetsGroup.style.display = inputs.customTargets.value.trim() ? 'none' : 'block';
        });

        copyBtn.addEventListener("click", () => copyTextToClipboard(urlDisplay.value));

        updateValueDisplays();
        updateLink();
    </script>
</body>
</html>
